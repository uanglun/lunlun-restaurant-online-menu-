<!DOCTYPE html>
<html lang="zh-Hant">
<head>
 <meta charset="UTF-8" />
 <title>ç¶¸ç¶¸é£²æ–™åº— ç·šä¸Šé»é¤ç³»çµ±</title>
 <style>
  body {
    font-family: sans-serif;
    background: #f6f6f6;
    padding: 20px;
    font-size: 16px;
  }
  h1 {
    text-align: center;
    font-size: 24px;
  }
  .category {
    margin-top: 30px;
  }
  .category h2 {
    border-bottom: 2px solid #ccc;
    padding-bottom: 5px;
    font-size: 20px;
  }
  .menu-item {
    background: #fff;
    margin: 10px 0;
    padding: 15px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-size: 16px;
    flex-wrap: wrap; /* å…è¨±é …ç›®æ›è¡Œ */
  }
  .menu-item .item-info {
    flex: 2;
    min-width: 180px; /* ç¢ºä¿è³‡è¨Šå€å¡Šæœ‰è¶³å¤ å¯¬åº¦ */
  }
  .menu-item .quantity-group {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 5px;
    min-width: 120px; /* ç¢ºä¿æ•¸é‡å€å¡Šæœ‰è¶³å¤ å¯¬åº¦ */
    margin-left: 10px;
  }
  .btn {
    padding: 6px 10px;
    cursor: pointer;
    background-color: #ff9800;
    color: white;
    border: none;
    border-radius: 4px;
    margin: 5px 5px 5px 0;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
  }
  .btn:hover {
    background-color: #e68900;
  }
  #menu-view, #cart-view {
    display: none;
  }
  .form-group {
    margin: 10px 0;
  }
  label {
    display: block;
    margin-bottom: 5px;
    font-size: 16px;
  }
  input, select, textarea {
    width: 100%;
    padding: 8px;
    border-radius: 4px;
    border: 1px solid #ccc;
    font-size: 16px;
    box-sizing: border-box;
  }
  .sugar-level, .ice-level {
    width: auto; /* è®“ä¸‹æ‹‰é¸å–®æ ¹æ“šå…§å®¹èª¿æ•´å¯¬åº¦ */
    margin-right: 5px; /* è®“ç³–åº¦å†°åº¦ä¹‹é–“æœ‰é–“éš” */
    max-width: 150px; /* é™åˆ¶ä¸‹æ‹‰é¸å–®æœ€å¤§å¯¬åº¦ */
  }
  .add-on-options {
      margin-top: 5px;
      font-size: 14px;
      padding-top: 5px;
      border-top: 1px dashed #eee;
  }
  .add-on-options label {
      display: inline-block;
      margin-right: 10px;
      margin-bottom: 5px;
  }
  #cart-list li {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px dashed #eee;
  }
  #cart-list li:last-child {
      border-bottom: none;
  }
  #cart-list .item-actions {
      display: flex;
      gap: 5px;
  }
  #cart-list .item-actions .btn-small {
      padding: 4px 8px;
      font-size: 14px;
      background-color: #007bff;
  }
  #cart-list .item-actions .btn-small.delete {
      background-color: #dc3545;
  }
  #cart-list .item-actions .btn-small:hover {
      opacity: 0.9;
  }
 </style>
</head>
<body>
 <h1>ç¶¸ç¶¸é£²æ–™åº— ç·šä¸Šé»é¤ç³»çµ±</h1>

<div id="success-view" style="display:none;">
 <h2>æ„Ÿè¬æ‚¨çš„è¨‚è³¼ï¼</h2>
 <p>æˆ‘å€‘å°‡ç‚ºæ‚¨æº–å‚™é¤é»ï¼Œé è¨ˆæ™‚é–“ç‚º 2~5 åˆ†é˜ï¼Œå¦‚é‡å°–å³°æ™‚æ®µé‚„è«‹æ‚¨è€å¿ƒç­‰å€™ã€‚<br>é€ æˆä¸ä¾¿ï¼Œæ•¬è«‹è¦‹è«’ï¼</p>
</div>

 <div id="menu-view">
   <div id="menu"></div>
   <button class="btn" onclick="showCart()">æŸ¥çœ‹è³¼ç‰©è»Š</button>
 </div>

 <div id="cart-view">
   <h2>ğŸ›’ è³¼ç‰©è»Šé é¢</h2>
   <ul id="cart-list"></ul>
   <p>ğŸ’µ ç¸½é‡‘é¡ï¼š<span id="total">0</span> å…ƒ</p>

   <div class="form-group">
     <label for="name">å§“åï¼š</label>
     <input type="text" id="name" placeholder="è«‹è¼¸å…¥å§“å">
   </div>
   <div class="form-group">
     <label for="phone">é›»è©±ï¼š</label>
     <input type="text" id="phone" placeholder="è«‹è¼¸å…¥é›»è©±">
   </div>
   <div class="form-group">
     <label for="orderType">ç”¨é¤æ–¹å¼ï¼š</label>
     <select id="orderType" onchange="toggleAddress()">
       <option value="å…§ç”¨">å…§ç”¨</option>
       <option value="å¤–å¸¶">å¤–å¸¶</option>
       <option value="å¤–é€">å¤–é€</
       option>
     </select>
   </div>
   <div class="form-group" id="addressGroup" style="display:none">
     <label for="address">åœ°å€ï¼ˆé™å¤–é€å¡«å¯«ï¼‰ï¼š</label>
     <input type="text" id="address" placeholder="è«‹è¼¸å…¥å¤–é€åœ°å€">
   </div>
   <div class="form-group">
     <label for="payment">ä»˜æ¬¾æ–¹å¼ï¼š</label>
     <select id="payment" onchange="toggleBarcode()">
       <option value="ç¾é‡‘">ç¾é‡‘</option>
       <option value="ä¿¡ç”¨å¡">ä¿¡ç”¨å¡</option>
       <option value="LINE PAY">LINE PAY</option>
       <option value="APPLE PAY">APPLE PAY</option>
     </select>
     <div class="form-group" id="paymentBarcodeGroup" style="display:none">
       <label id="paymentBarcodeLabel" for="paymentBarcodeInput">è«‹è¼¸å…¥ä»˜æ¬¾ç¢¼ï¼š</label>
       <input type="text" id="paymentBarcodeInput" placeholder="è«‹è¼¸å…¥ä»˜æ¬¾ç¢¼">
     </div>
   </div>

   <div class="form-group">
     <label for="invoiceType">ç™¼ç¥¨çµ¦äºˆæ–¹å¼ï¼š</label>
     <select id="invoiceType" onchange="toggleInvoiceFields()">
       <option value="ç´™æœ¬ç™¼ç¥¨">ç´™æœ¬ç™¼ç¥¨</option>
       <option value="è¼‰å…·">è¼‰å…·</option>
       <option value="çµ±ç·¨">çµ±ç·¨</option>
     </select>
   </div>

   <div class="form-group" id="carrierGroup" style="display:none">
     <label for="carrier">è¼‰å…·æ¢ç¢¼ï¼š</label>
     <input type="text" id="carrier" placeholder="è«‹è¼¸å…¥è¼‰å…·æ¢ç¢¼">
   </div>

   <div class="form-group" id="taxIdGroup" style="display:none">
     <label for="taxId">çµ±ä¸€ç·¨è™Ÿï¼š</label>
     <input type="text" id="taxId" placeholder="è«‹è¼¸å…¥çµ±ä¸€ç·¨è™Ÿ">
   </div>

   <div class="form-group">
     <label for="notes">å‚™è¨»ï¼š</label>
     <textarea id="notes" rows="3" placeholder="ä¾‹å¦‚ï¼šå°‘å†°ã€å¾®ç³–ã€ä¸è¦åŠ çç ã€é€é¤å‰è«‹é›»è¯..."></textarea>
   </div>
   <button class="btn" onclick="submitOrder()">é€å‡ºè¨‚å–®</button>
   <button class="btn" onclick="removeItems()">æ¸…ç©ºè³¼ç‰©è»Š</button>
   <button class="btn" onclick="showMenu()">å›åˆ°é¸å–®</button>
   <p id="message"></p>
 </div>

 <script>
   const menuItems = {
     "é®®å¥½èŒ¶": [
       { name: "èŒ‰è‰ç¶ èŒ¶", price: 30 },
       { name: "é«˜å±±é’èŒ¶", price: 30 },
       { name: "é ‚ç´šçƒé¾èŒ¶", price: 40 },
       { name: "å¤æ—©å‘³ç´…èŒ¶", price: 30 }, // æ–°å¢ä¸¦æ”¾åœ¨é€™è£¡
       { name: "èŠ±é¦™ç´…èŒ¶", price: 35 },
       { name: "é‡‘è±èŒ¶", price: 40 }, // è®Šæ›´ä½ç½®
       { name: "å¤æ—©å‘³å†¬ç“œèŒ¶(ç³–åº¦å›ºå®š)", price: 30 },
       { name: "å¤æ—©å‘³éº¥èŒ¶", price: 30 }
     ],
     "æ‰¾æ–°é®®": [
       { name: "æª¸æª¬å¤šå¤š", price: 45 },
       { name: "ç™¾é¦™CC", price: 50 },
       { name: "ç™¾é¦™å¤šå¤š", price: 55 },
       { name: "æŸ³æ©™ç¶ èŒ¶", price: 55 },
       { name: "ç™¾é¦™æŸ³æ©™èŒ¶", price: 55 },
       { name: "æ¥Šæç”˜éœ²", price: 75 },
       { name: "ç¹½ç´›æ°´æœèŒ¶", price: 50 },
     ],
     "æƒ³å–å¥¶": [
       { name: "é»‘ç³–çç é®®å¥¶", price: 65 },
       { name: "é»‘ç³–å¥¶èŒ¶", price: 50 },
       { name: "çç å¥¶èŒ¶", price: 60 },
       { name: "èŠ‹é ­é®®å¥¶", price: 55 },
       { name: "é»‘ç³–é®®å¥¶", price: 55 },
       { name: "èŠ‹é ­å¥¶èŒ¶", price: 60 }
     ],
    "æ‰¾æœæ±": [
       { name: "æŸ³æ©™æ±", price: 55 },
       { name: "è¥¿ç“œæ±", price: 55 },
       { name: "è‘¡è„æ±", price: 55 },
       { name: "è¥¿ç“œç‰›å¥¶", price: 60 },
       { name: "è‘¡è„æŸšæ±", price: 60 },
       { name: "ç¶œåˆæœæ±", price: 70 },
       { name: "è‘¡è„è˜‹æœæ±", price: 70 },
       { name: "ç´«è‰²è”¬æœæ±", price: 65 }
    ],
     "ä¾†é»å†°(5æœˆ~10æœˆé™å®š)": [
       { name: "èŠ’æœå†°æ²™", price: 65 },
       { name: "è¥¿ç“œå†°æ²™", price: 65 },
       { name: "èŠ’æœç‰›å¥¶å†°æ²™", price: 70 },
       { name: "å‰‰å†°", price: 60 },
       { name: "èŠ’æœå‰‰å†°", price: 75 },
       { name: "è¥¿ç“œå‰‰å†°", price: 75 },
       { name: "ç‰›å¥¶å†°æ²™", price: 70 },
       { name: "é¸æ–™å†°æ²™(é™å…§ç”¨ã€ä¾†åº—å¤–å¸¶ï¼Œæœ€å¤šé¸2ç¨®æ–™)", price: 80 }
     ],
     "å¥½æº«æš–(11æœˆ~3æœˆé™å®š)": [
       { name: "æ¡‚åœ“èŒ¶", price: 50 },
       { name: "æ¡‚åœ“ç´…æ£—èŒ¶", price: 55 }
    ]
   };

   // å®šç¾©åŠ é»æ–™çš„é …ç›®å’Œåƒ¹æ ¼
   const addOnItems = {
       "å°çç ": 10,
       "æ³¢éœ¸": 10,
       "æ¤°æœ": 10,
       "ä»™è‰å‡": 15,
       "ç²‰ç²¿": 15,
       "ç²‰è§’": 15,
       "ç²‰æ¢": 15,
       "ç‰›å¥¶": 20
   };

   const cart = [];

   function renderMenu() {
     const menuDiv = document.getElementById("menu");
     menuDiv.innerHTML = ''; // æ¸…ç©ºåŸæœ‰å…§å®¹ï¼Œé¿å…é‡è¤‡æ¸²æŸ“
     Object.keys(menuItems).forEach(category => {
       const categoryDiv = document.createElement("div");
       categoryDiv.className = "category";
       const header = document.createElement("h2");
       header.textContent = category;
       categoryDiv.appendChild(header);

       menuItems[category].forEach(item => {
         // ç‚ºæ¯å€‹èœå–®é …ç›®å‰µå»ºä¸€å€‹ç¨ç‰¹çš„ IDï¼Œä»¥ä¾¿æ–¼ç·¨è¼¯æ™‚å®šä½
         const menuItemUniqueId = `${category}-${item.name.replace(/[^a-zA-Z0-9-]/g, '')}`;

         const el = document.createElement("div");
         el.className = "menu-item";
         el.setAttribute('data-menu-item-id', menuItemUniqueId); // æ·»åŠ  data å±¬æ€§

         let optionsHtml = '';
         
         const sugarOptions = ["æ­£å¸¸ç³–", "å°‘ç³–", "åŠç³–", "å¾®ç³–", "ç„¡ç³–"];
         const iceOptions = ["æ­£å¸¸å†°", "å°‘å†°", "å¾®å†°", "å»å†°", "æº«", "ç†±"];

         // åˆ¤æ–·è©²å“é …æ˜¯å¦æ‡‰è©²æœ‰ç³–åº¦é¸é …
         let hasSugarOption = ["é®®å¥½èŒ¶", "æ‰¾æ–°é®®"].includes(category);
         if (item.name === "æ¥Šæç”˜éœ²" || category === "æƒ³å–å¥¶") {
             hasSugarOption = false;
         }

         // åˆ¤æ–·è©²å“é …æ˜¯å¦æ‡‰è©²æœ‰å†°åº¦é¸é …
         let hasIceOption = ["é®®å¥½èŒ¶", "æ‰¾æ–°é®®", "æƒ³å–å¥¶", "æ‰¾æœæ±"].includes(category);
         if (["ä¾†é»å†°(5æœˆ~10æœˆé™å®š)", "å¥½æº«æš–(11æœˆ~3æœˆé™å®š)"].includes(category)) {
             hasIceOption = false;
         }

         // åˆ¤æ–·è©²å“é …æ˜¯å¦æ‡‰è©²æœ‰åŠ é»æ–™é¸é …
         let hasAddOnOption = ["é®®å¥½èŒ¶", "æ‰¾æ–°é®®"].includes(category);
         if (["æ¥Šæç”˜éœ²", "ç¹½ç´›æ°´æœèŒ¶"].includes(item.name) || category === "æƒ³å–å¥¶") {
             hasAddOnOption = false;
         }


         let sugarSelectHtml = '';
         if (hasSugarOption) {
             sugarSelectHtml = `<select class="sugar-level" id="sugar-${menuItemUniqueId}">`;
             sugarOptions.forEach(option => {
               if (item.name === "å¤æ—©å‘³å†¬ç“œèŒ¶(ç³–åº¦å›ºå®š)") {
                 sugarSelectHtml += `<option value="${option}" ${option === "æ­£å¸¸ç³–" ? "selected" : "disabled"}>${option}</option>`;
               } else {
                 sugarSelectHtml += `<option value="${option}">${option}</option>`;
               }
             });
             sugarSelectHtml += `</select>`;
         }

         let iceSelectHtml = '';
         if (hasIceOption) {
             iceSelectHtml = `<select class="ice-level" id="ice-${menuItemUniqueId}">`;
             iceOptions.forEach(option => {
               if (category === "æ‰¾æœæ±") {
                 if (option !== "æº«" && option !== "ç†±") {
                   iceSelectHtml += `<option value="${option}">${option}</option>`;
                 }
               } else {
                 iceSelectHtml += `<option value="${option}">${option}</option>`;
               }
             });
             iceSelectHtml += `</select>`;
         }

         if (hasSugarOption || hasIceOption) {
             optionsHtml += `
               <div style="font-size: 14px; margin-top: 5px;">
                 ${hasSugarOption ? `ç³–åº¦: ${sugarSelectHtml}` : ''} 
                 ${hasIceOption ? `å†°åº¦: ${iceSelectHtml}` : ''}
               </div>
             `;
         }
        
         if (hasAddOnOption) {
             let addOnCheckboxesHtml = '<div class="add-on-options">åŠ é»æ–™: ';
             for (const addOnName in addOnItems) {
                 const addOnPrice = addOnItems[addOnName];
                 addOnCheckboxesHtml += `
                     <label>
                         <input type="checkbox" class="add-on-checkbox" id="addon-${menuItemUniqueId}-${addOnName.replace(/[^a-zA-Z0-9-]/g, '')}" data-add-on-name="${addOnName}" data-add-on-price="${addOnPrice}">
                         ${addOnName} ($${addOnPrice})
                     </label>
                 `;
             }
             addOnCheckboxesHtml += '</div>';
             optionsHtml += addOnCheckboxesHtml;
         }

         el.innerHTML = `
           <div class="item-info">
             <div>${item.name} - ${item.price} å…ƒ</div>
             ${optionsHtml}
           </div>
           <div class="quantity-group">
             æ•¸é‡ï¼š
             <select class="quantity" id="qty-${menuItemUniqueId}">
               ${[...Array(10).keys()].map(i => `<option value="${i+1}">${i+1}</option>`).join("")}
             </select>
           </div>
           <button class="btn" onclick="addToCart(this, '${item.name}', ${item.price}, '${category}', '${menuItemUniqueId}')">åŠ å…¥è³¼ç‰©è»Š</button>
         `;
         categoryDiv.appendChild(el);
       });

       menuDiv.appendChild(categoryDiv);
     });
   }

   function addToCart(button, name, basePrice, category, menuItemUniqueId) {
     const parentItem = button.closest('.menu-item');
     const quantity = parseInt(parentItem.querySelector(".quantity").value);

     const sugarSelect = parentItem.querySelector(".sugar-level");
     const iceSelect = parentItem.querySelector(".ice-level");
     
     const sugarLevel = sugarSelect ? sugarSelect.value : "";
     const iceLevel = iceSelect ? iceSelect.value : "";

     let currentPrice = basePrice;
     const selectedAddOns = [];
     
     const addOnCheckboxes = parentItem.querySelectorAll('.add-on-checkbox:checked');
     addOnCheckboxes.forEach(checkbox => {
         const addOnName = checkbox.dataset.addOnName;
         const addOnPrice = parseInt(checkbox.dataset.addOnPrice);
         selectedAddOns.push({ name: addOnName, price: addOnPrice });
         currentPrice += addOnPrice;
     });

     let displayCartName = name;
     let optionsDisplay = [];
     if (sugarLevel) optionsDisplay.push(sugarLevel);
     if (iceLevel) optionsDisplay.push(iceLevel);
     
     if (optionsDisplay.length > 0) {
        displayCartName = `${name} (${optionsDisplay.join('')})`;
     }

     const addOnNamesForId = selectedAddOns.map(ao => ao.name).sort().join('-');
     const uniqueItemKey = `${name}-${sugarLevel}-${iceLevel}-${addOnNamesForId}`;

     const existing = cart.find(item => item.uniqueKey === uniqueItemKey);

     if (existing) {
       existing.quantity += quantity;
     } else {
       cart.push({
         name: name,
         basePrice: basePrice,
         price: currentPrice,
         quantity: quantity,
         sugar: sugarLevel,
         ice: iceLevel,
         selectedAddOns: selectedAddOns,
         cartName: displayCartName,
         uniqueKey: uniqueItemKey,
         originalCategory: category, // å„²å­˜åŸå§‹é¡åˆ¥
         menuItemUniqueId: menuItemUniqueId // å„²å­˜èœå–®é …ç›®çš„å”¯ä¸€ID
       });
     }
     
     // é‡ç½®åŠ é»æ–™çš„é¸å–ç‹€æ…‹å’Œæ•¸é‡ã€ç³–åº¦ã€å†°åº¦
     parentItem.querySelector(".quantity").value = "1"; // æ•¸é‡é‡ç½®ç‚º1
     if (sugarSelect) sugarSelect.value = "æ­£å¸¸ç³–"; // ç³–åº¦é‡ç½®
     if (iceSelect) iceSelect.value = "æ­£å¸¸å†°"; // å†°åº¦é‡ç½®
     addOnCheckboxes.forEach(checkbox => {
         checkbox.checked = false;
     });

     showToast(`å·²åŠ å…¥ ${quantity} ä»½ ${displayCartName}`);
   }

   function showMenu() {
     document.getElementById("menu-view").style.display = "block";
     document.getElementById("cart-view").style.display = "none";
     document.getElementById("success-view").style.display = "none";
     // é‡æ–°æ¸²æŸ“èœå–®ä»¥ç¢ºä¿æ‰€æœ‰é¸é …éƒ½é‡ç½®
     renderMenu(); 
   }

   function showCart() {
     document.getElementById("menu-view").style.display = "none";
     document.getElementById("cart-view").style.display = "block";
     document.getElementById("success-view").style.display = "none";

     const list = document.getElementById("cart-list");
     const totalEl = document.getElementById("total");
     list.innerHTML = "";
     let total = 0;
     cart.forEach((item, index) => {
       const li = document.createElement("li");
       let itemText = `${item.cartName} x ${item.quantity}`;
       
       if (item.selectedAddOns && item.selectedAddOns.length > 0) {
           const addOnNames = item.selectedAddOns.map(ao => ao.name).join(', ');
           itemText += ` (åŠ : ${addOnNames})`;
       }
       itemText += ` - ${item.price * item.quantity} å…ƒ`;
       
       li.innerHTML = `
            <span>${itemText}</span>
            <div class="item-actions">
                <button class="btn btn-small" onclick="editCartItem(${index})">ç·¨è¼¯</button>
                <button class="btn btn-small delete" onclick="deleteCartItem(${index})">åˆªé™¤</button>
            </div>
       `;
       list.appendChild(li);
       total += item.price * item.quantity;
     });
     totalEl.textContent = total;
     document.getElementById("message").textContent = "";
   }

   function deleteCartItem(index) {
       if (confirm("ç¢ºå®šè¦å¾è³¼ç‰©è»Šä¸­åˆªé™¤æ­¤å•†å“å—ï¼Ÿ")) {
           cart.splice(index, 1);
           showCart(); // é‡æ–°é¡¯ç¤ºè³¼ç‰©è»Š
           showToast("å•†å“å·²å¾è³¼ç‰©è»Šä¸­åˆªé™¤ã€‚");
       }
   }

   function editCartItem(index) {
       const itemToEdit = cart[index];
       // å¾è³¼ç‰©è»Šä¸­ç§»é™¤è©²é …ï¼Œå› ç‚ºæˆ‘å€‘å°‡é‡æ–°æ·»åŠ å®ƒ
       cart.splice(index, 1); 
       
       showMenu(); // è¿”å›èœå–®é é¢

       // ç­‰å¾…èœå–®æ¸²æŸ“å®Œæˆï¼Œç„¶å¾Œé å¡«é¸é …
       setTimeout(() => {
           prefillMenuItem(itemToEdit);
       }, 50); // çŸ­æš«å»¶é²ç¢ºä¿DOMæ›´æ–°
   }

   function prefillMenuItem(item) {
       const menuItemDiv = document.querySelector(`[data-menu-item-id="${item.menuItemUniqueId}"]`);
       if (menuItemDiv) {
           // é å¡«æ•¸é‡
           const quantitySelect = menuItemDiv.querySelector(".quantity");
           if (quantitySelect) {
               quantitySelect.value = item.quantity;
           }

           // é å¡«ç³–åº¦
           const sugarSelect = menuItemDiv.querySelector(".sugar-level");
           if (sugarSelect) {
               sugarSelect.value = item.sugar;
           }

           // é å¡«å†°åº¦
           const iceSelect = menuItemDiv.querySelector(".ice-level");
           if (iceSelect) {
               iceSelect.value = item.ice;
           }

           // é å¡«åŠ é»æ–™
           item.selectedAddOns.forEach(addOn => {
               const addOnCheckbox = menuItemDiv.querySelector(`.add-on-checkbox[data-add-on-name="${addOn.name}"]`);
               if (addOnCheckbox) {
                   addOnCheckbox.checked = true;
               }
           });

           // å¯ä»¥æ»¾å‹•åˆ°è©²é …ç›®ï¼Œè®“ç”¨æˆ¶æ›´å®¹æ˜“çœ‹åˆ°
           menuItemDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
           showToast(`æ­£åœ¨ç·¨è¼¯ ${item.name}ï¼Œè«‹ä¿®æ”¹å¾Œå†æ¬¡åŠ å…¥è³¼ç‰©è»Šã€‚`);

       } else {
           console.warn("æœªæ‰¾åˆ°è¦ç·¨è¼¯çš„èœå–®é …ç›®ï¼š", item.menuItemUniqueId);
           showToast("ç„¡æ³•æ‰¾åˆ°è¦ç·¨è¼¯çš„å•†å“ï¼Œè«‹æ‰‹å‹•é‡æ–°é¸æ“‡ã€‚");
       }
   }


   function removeItems() {
     cart.length = 0;
     showCart();
     document.getElementById("message").textContent = "è³¼ç‰©è»Šå·²æ¸…ç©ºã€‚";
   }

   function toggleAddress() {
     const orderType = document.getElementById("orderType").value;
     document.getElementById("addressGroup").style.display = orderType === "å¤–é€" ? "block" : "none";
   }

   function toggleInvoiceFields() {
     const type = document.getElementById("invoiceType").value;
     document.getElementById("carrierGroup").style.display = type === "è¼‰å…·" ? "block" : "none";
     document.getElementById("taxIdGroup").style.display = type === "çµ±ç·¨" ? "block" : "none";
   }

   function toggleBarcode() {
     const payment = document.getElementById("payment").value;
     const barcodeGroup = document.getElementById("paymentBarcodeGroup");
     const barcodeLabel = document.getElementById("paymentBarcodeLabel");

     if (payment === "LINE PAY" || payment === "APPLE PAY") {
       barcodeGroup.style.display = "block";
       barcodeLabel.textContent = `è«‹è¼¸å…¥ ${payment} ä»˜æ¬¾ç¢¼ï¼š`;
     } else {
       barcodeGroup.style.display = "none";
     }
   }

   function submitOrder() {
     if (cart.length === 0) {
       document.getElementById("message").textContent = "è«‹å…ˆé¸æ“‡é¤é»å–”ï¼";
       return;
     }

     const name = document.getElementById("name").value;
     const phone = document.getElementById("phone").value;
     const orderType = document.getElementById("orderType").value;
     const address = document.getElementById("address").value;
     const payment = document.getElementById("payment").value;
     const notes = document.getElementById("notes").value;

     const invoiceType = document.getElementById("invoiceType").value;
     const paymentBarcodeInput = document.getElementById("paymentBarcodeInput").value;

     if ((payment === "LINE PAY" || payment === "APPLE PAY") && !paymentBarcodeInput) {
       document.getElementById("message").textContent = `è«‹è¼¸å…¥ ${payment} çš„ä»˜æ¬¾ç¢¼ã€‚`;
       return;
     }

     const carrier = document.getElementById("carrier").value;
     const taxId = document.getElementById("taxId").value;

     if (!name || !phone || (orderType === "å¤–é€" && !address)) {
       document.getElementById("message").textContent = "è«‹å®Œæ•´å¡«å¯«æ‰€æœ‰å¿…è¦æ¬„ä½ã€‚";
       return;
     }

     if (invoiceType === "è¼‰å…·" && !carrier) {
       document.getElementById("message").textContent = "è«‹è¼¸å…¥è¼‰å…·æ¢ç¢¼ã€‚";
       return;
     }

     if (invoiceType === "çµ±ç·¨" && !taxId) {
       document.getElementById("message").textContent = "è«‹è¼¸å…¥çµ±ä¸€ç·¨è™Ÿã€‚";
       return;
     }

     console.log("è¨‚å–®è³‡è¨Šï¼š");
     console.log("å§“åï¼š", name);
     console.log("é›»è©±ï¼š", phone);
     console.log("ç”¨é¤æ–¹å¼ï¼š", orderType);
     if (orderType === "å¤–é€") {
       console.log("åœ°å€ï¼š", address);
     }
     console.log("ä»˜æ¬¾æ–¹å¼ï¼š", payment);
     if (payment === "LINE PAY" || payment === "APPLE PAY") {
       console.log("ä»˜æ¬¾ç¢¼ï¼š", paymentBarcodeInput);
     }
     console.log("ç™¼ç¥¨æ–¹å¼ï¼š", invoiceType);
     if (invoiceType === "è¼‰å…·") {
       console.log("è¼‰å…·æ¢ç¢¼ï¼š", carrier);
     }
     if (invoiceType === "çµ±ç·¨") {
       console.log("çµ±ä¸€ç·¨è™Ÿï¼š", taxId);
     }
     console.log("å‚™è¨»ï¼š", notes);
     console.log("è³¼ç‰©è»Šå…§å®¹ï¼š", cart);
     console.log("ç¸½é‡‘é¡ï¼š", document.getElementById("total").textContent);


     document.getElementById("cart-view").style.display = "none";
     document.getElementById("success-view").style.display = "block";
     cart.length = 0; // æ¸…ç©ºè³¼ç‰©è»Š
     // æ¸…ç©ºè¡¨å–®æ¬„ä½
     document.getElementById("name").value = "";
     document.getElementById("phone").value = "";
     document.getElementById("address").value = "";
     document.getElementById("paymentBarcodeInput").value = "";
     document.getElementById("carrier").value = "";
     document.getElementById("taxId").value = "";
     document.getElementById("notes").value = "";
     document.getElementById("message").textContent = "";
   }

   function showToast(message) {
     const toast = document.getElementById("toast");
     toast.textContent = message;
     toast.style.display = "block";
     setTimeout(() => {
       toast.style.display = "none";
     }, 2000);
   }

   showMenu(); // é¦–æ¬¡è¼‰å…¥é é¢æ™‚é¡¯ç¤ºèœå–®
   renderMenu(); // é¦–æ¬¡è¼‰å…¥é é¢æ™‚æ¸²æŸ“èœå–®
 </script>

<div id="toast" style="display:none; position:fixed; bottom:20px; left:50%; transform:translateX(-50%);
 background-color:#333; color:#fff; padding:10px 20px; border-radius:5px; font-size:16px; z-index:1000;">
 å·²åŠ å…¥è³¼ç‰©è»Šï¼
</div>

</body>
</html>